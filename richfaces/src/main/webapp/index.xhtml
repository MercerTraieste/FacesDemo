<?xml version="1.0" encoding="UTF-8"?>

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:a4j="http://richfaces.org/a4j"
                xmlns:rich="http://richfaces.org/rich"
                template="/templates/template.xhtml">

<ui:define name="title">RichFrichs</ui:define>

<ui:define name="body">
<h:form prependId="false">
<rich:panel header="#{text['panelHeader1']}">
    <h:panelGrid columns="2">
        <h:outputText id="languageLabel" value="#{text['language']}"/>
        <rich:select id="selectLanguage" value="#{localeBean.language}">
            <f:selectItems value="#{localeBean.languages}"/>
            <a4j:ajax event="selectitem" execute="@all" render="@all"/>
        </rich:select>
    </h:panelGrid>
</rich:panel>

<rich:panel header="#{text['panelHeader2']}">
    <rich:tabPanel switchType="ajax">

        <rich:tab name="#{text['tabsFormLabel']}">

            <h:panelGrid columns="3">
                <h:outputText value="#{text['calendar']}"/>
                <rich:calendar id="calendarRich" value="#{richBean.calendar}"/>
                <rich:message for="calendarRich"/>

                <h:outputText value="#{text['firstName']}"/>
                <h:inputText id="nameInput" value="#{richBean.name}"/>
                <rich:message for="nameInput"/>
            </h:panelGrid>

            <a4j:outputPanel title="#{text['uploadFileTitle']}">
                <rich:fileUpload fileUploadListener="#{fileUpload.uploadFileListener}"
                                 addLabel="#{text['chooseFile']}"
                                 clearAllLabel="#{text['clearAllFiles']}"
                                 uploadLabel="#{text['uploadFiles']}"
                                 deleteLabel="#{text['deleteFile']}"/>
            </a4j:outputPanel>

        </rich:tab>

        <rich:tab name="#{text['tabsTableLabel']}">
            <h:panelGrid columns="1">
                <rich:extendedDataTable value="#{dataBean.children}"
                                        var="child"
                                        style="height:300px; width:510px">
                    <a4j:ajax event="selectionchange" listener="#{dataBean.showSelectionDetails}"
                              render="childDetails"/>
                    <f:facet name="header">
                        <h:outputText value="#{text['tabsTableLabel']}"/>
                    </f:facet>
                    <rich:column sortBy="#{child.id}" style="width:75px">
                        <f:facet name="header">
                            <h:outputText value="#{text['id']}"/>
                        </f:facet>
                        <h:outputText value="#{child.id}"/>
                    </rich:column>
                    <rich:column sortBy="#{child.firstName}" style="width:175px">
                        <f:facet name="header">
                            <h:outputText value="#{text['firstName']}"/>
                        </f:facet>
                        <h:outputText value="#{child.firstName}"/>
                    </rich:column>
                    <rich:column sortBy="#{child.lastName}" style="width:175px">
                        <f:facet name="header">
                            <h:outputText value="#{text['lastName']}"/>
                        </f:facet>
                        <h:outputText value="#{child.lastName}"/>
                    </rich:column>
                    <rich:column sortBy="#{child.age}" style="width:75px">
                        <f:facet name="header">
                            <h:outputText value="#{text['age']}"/>
                        </f:facet>
                        <h:outputText value="#{child.age}"/>
                    </rich:column>
                    <rich:column sortBy="#{child.sex}" style="width:75px">
                        <f:facet name="header">
                            <h:outputText value="#{text['sex']}"/>
                        </f:facet>
                        <h:outputText value="#{child.sex}"/>
                    </rich:column>
                </rich:extendedDataTable>

                <rich:dataGrid value="#{dataBean.selectedChildren}"
                               id="childDetails"
                               var="child">
                    <rich:panel style="width:500px; height:150px;"
                                header="Child Details">
                        <h:panelGrid columns="2" cellpadding="4">
                            <h:outputText value="#{text.id}:"/>
                            <h:outputText value="#{child.id}"/>

                            <h:outputText value="#{text.firstName}:"/>
                            <h:outputText value="#{child.firstName}"/>

                            <h:outputText value="#{text.lastName}:"/>
                            <h:outputText value="#{child.lastName}"/>

                            <h:outputText value="#{text.age}:"/>
                            <h:outputText value="#{child.age}"/>

                            <h:outputText value="#{text.sex}:"/>
                            <h:outputText value="#{child.sex}"/>
                        </h:panelGrid>
                    </rich:panel>
                </rich:dataGrid>
            </h:panelGrid>
        </rich:tab>

        <rich:tab name="#{text['tabsTextEditorLabel']}">

            <rich:editor toolbar="full" plugins="save,paste" value="#{richBean.editorValue}">
            </rich:editor>

            <a4j:commandButton value="Save" render="comment"/>
            <h:panelGrid columns="2">
                <h:outputText value="#{text['comment']} :"/>
                <h:outputText id="comment" value="#{richBean.editorValue}" rendered="true"/>
            </h:panelGrid>
        </rich:tab>

        <rich:tab name="#{text['tabsEditableList']}" style="height:300px; width:500px;">
            <a4j:outputPanel style="height:300px; width:500px; overflow:auto;">
                <rich:dataTable value="#{dataBean.childrenEditableList}" id="childrenTable"
                                var="child" iterationStatusVar="it"
                        >

                    <f:facet name="header">
                        <h:outputText value="#{text['tabsEditableList']}"/>
                    </f:facet>
                    <rich:column sortBy="#{child.id}" style="width:75px">
                        <f:facet name="header">
                            <h:outputText value="#{text['id']}"/>
                        </f:facet>
                        <h:outputText value="#{child.id}"/>
                    </rich:column>
                    <rich:column sortBy="#{child.firstName}"
                                 style="width:175px">
                        <f:facet name="header">
                            <h:outputText value="#{text['firstName']}"/>
                        </f:facet>
                        <h:outputText value="#{child.firstName}"/>
                    </rich:column>
                    <rich:column sortBy="#{child.age}" style="width:75px">
                        <f:facet name="header">
                            <h:outputText value="#{text['age']}"/>
                        </f:facet>
                        <h:outputText value="#{child.age}"/>
                    </rich:column>
                    <rich:column>
                        <a4j:commandLink styleClass="no-decor" execute="@this"
                                         render="@none" oncomplete="#{rich:component('confirmPane')}.show()">
                            <h:outputText value="Delete "/>
                            <a4j:param value="#{it.index}"
                                       assignTo="#{dataBean.currentChildIndex}"/>
                        </a4j:commandLink>

                        <a4j:commandLink styleClass="no-decor" render="editGrid"
                                         execute="@this" oncomplete="#{rich:component('editPane')}.show()">
                            <h:outputText value="Edit"/>
                            <a4j:param value="#{it.index}"
                                       assignTo="#{dataBean.currentChildIndex}"/>
                            <a4j:param value="false"
                                       assignTo="#{dataBean.childInAddMode}"/>
                            <f:setPropertyActionListener target="#{dataBean.currentChild}"
                                                         value="#{child}"/>
                        </a4j:commandLink>
                    </rich:column>
                </rich:dataTable>

                <a4j:commandLink styleClass="no-decor" render="editGrid" actionListener="#{dataBean.createNewChild}"
                                 execute="childrenTable" oncomplete="#{rich:component('editPane')}.show()">
                    <h:outputText value="Add Child"/>
                    <a4j:param value="true"
                                       assignTo="#{dataBean.childInAddMode}"/>
                </a4j:commandLink>

                <a4j:jsFunction name="remove" action="#{dataBean.removeChild}"
                                render="childrenTable" execute="@this"
                                oncomplete="#{rich:component('confirmPane')}.hide();"/>

                <rich:popupPanel id="statPane" autosized="true">
                    <!--<h:graphicImage value="/images/ai.gif" alt="ai" />-->
                    Please wait...
                </rich:popupPanel>

                <rich:popupPanel id="confirmPane" autosized="true">
                    Are you sure you want to delete the row?
                    <a4j:commandButton value="Cancel"
                                       onclick="#{rich:component('confirmPane')}.hide(); return false;"/>
                    <a4j:commandButton value="Delete" onclick="remove(); return false;"/>
                </rich:popupPanel>

                <rich:popupPanel header="Edit Child Details" id="editPane" domElementAttachment="parent" width="400"
                                 height="170">
                    <h:panelGrid columns="3" id="editGrid">
                        <h:outputText value="Age"/>
                        <h:outputText value="#{dataBean.currentChild.age}"/>
                        <h:panelGroup/>

                        <h:outputText value="Last Name"/>
                        <h:outputText value="#{dataBean.currentChild.lastName}"/>
                        <h:panelGroup/>

                        <h:outputText value="First Name"/>
                        <h:inputText value="#{dataBean.currentChild.firstName}"
                                     label="Mileage field">
                        </h:inputText>

                    </h:panelGrid>
                    <a4j:commandButton value="Store" action="#{dataBean.storeChild}"
                                       render="childrenTable" execute="editPane"
                                       oncomplete="if (#{facesContext.maximumSeverity==null}) {#{rich:component('editPane')}.hide();}"/>
                    <a4j:commandButton value="Cancel" actionListener="#{dataBean.cancelChild}"
                                       oncomplete="#{rich:component('editPane')}.hide(); return false;"/>
                </rich:popupPanel>
            </a4j:outputPanel>
        </rich:tab>

    </rich:tabPanel>
</rich:panel>
</h:form>
</ui:define>
</ui:composition>
